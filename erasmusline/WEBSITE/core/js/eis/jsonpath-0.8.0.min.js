function jsonPath(m,n,o){var e={resultType:o&&o.resultType||"VALUE",result:[],normalize:function(a){var d=[];return a.replace(/[\['](\??\(.*?\))[\]']/g,function(b,c){return"[#"+(d.push(c)-1)+"]"}).replace(/'?\.'?|\['?/g,";").replace(/;;;|;;/g,";..;").replace(/;$|'?\]|'$/g,"").replace(/#([0-9]+)/g,function(b,c){return d[c]})},asPath:function(a){a=a.split(";");for(var d="$",b=1,c=a.length;b<c;b++)d+=/^[0-9*]+$/.test(a[b])?"["+a[b]+"]":"['"+a[b]+"']";return d},store:function(a,d){if(a)e.result[e.result.length]=
e.resultType=="PATH"?e.asPath(a):d;return!!a},trace:function(a,d,b){if(a){a=a.split(";");var c=a.shift();a=a.join(";");if(d&&d.hasOwnProperty(c))e.trace(a,d[c],b+";"+c);else if(c==="*")e.walk(c,a,d,b,function(f,j,l,i,k){e.trace(f+";"+l,i,k)});else if(c===".."){e.trace(a,d,b);e.walk(c,a,d,b,function(f,j,l,i,k){typeof i[f]==="object"&&e.trace("..;"+l,i[f],k+";"+f)})}else if(/,/.test(c)){c=c.split(/'?,'?/);for(var h=0,g=c.length;h<g;h++)e.trace(c[h]+";"+a,d,b)}else if(/^\(.*?\)$/.test(c))e.trace(e.eval(c,
d,b.substr(b.lastIndexOf(";")+1))+";"+a,d,b);else if(/^\?\(.*?\)$/.test(c))e.walk(c,a,d,b,function(f,j,l,i,k){e.eval(j.replace(/^\?\((.*?)\)$/,"$1"),i[f],f)&&e.trace(f+";"+l,i,k)});else/^(-?[0-9]*):(-?[0-9]*):?([0-9]*)$/.test(c)&&e.slice(c,a,d,b)}else e.store(b,d)},walk:function(a,d,b,c,h){if(b instanceof Array)for(var g=0,f=b.length;g<f;g++)g in b&&h(g,a,d,b,c);else if(typeof b==="object")for(g in b)b.hasOwnProperty(g)&&h(g,a,d,b,c)},slice:function(a,d,b,c){if(b instanceof Array){var h=b.length,
g=0,f=h,j=1;a.replace(/^(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)$/g,function(l,i,k,p){g=parseInt(i||g);f=parseInt(k||f);j=parseInt(p||j)});g=g<0?Math.max(0,g+h):Math.min(h,g);f=f<0?Math.max(0,f+h):Math.min(h,f);for(a=g;a<f;a+=j)e.trace(a+";"+d,b,c)}},eval:function(a,d){try{return q&&d&&eval(a.replace(/@/g,"_v"))}catch(b){throw new SyntaxError("jsonPath: "+b.message+": "+a.replace(/@/g,"_v").replace(/\^/g,"_a"));}}},q=m;if(n&&m&&(e.resultType=="VALUE"||e.resultType=="PATH")){e.trace(e.normalize(n).replace(/^\$;/,
""),m,"$");return e.result.length?e.result:false}};
